<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">    <style>        * {
            box-sizing: border-box;
            max-width: 100%;
        }
        body, html { 
            height: 100%; 
            margin: 0; 
            padding: 0; 
            overflow-x: hidden; 
            max-width: 100vw; 
        }        .top-header {
            text-align: center;
            margin-top: 32px;
            font-size: 2.2rem;
            font-weight: 300;
            letter-spacing: 0.5px;
        }
        .go-back-btn {
            position: fixed;
            top: 90px;
            left: 18px;
            background: none;
            border: none;
            font-size: 1.1rem;
            color: #072e46; 
            cursor: pointer;
            padding: 0;
            z-index: 1001;
        }
        .dark-theme .go-back-btn {
            color: #fff;
        }
        .main-content {
            padding-top: 100px;
        }
        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background-color: #072e46;
            color: white;
            width: 100%;
        }
        .header-left {
            display: flex;
            align-items: center;
        }
        .logo {
            height: 60px;
            margin: 0 20px;
        }
        .title-text {
            font-size: 1.1rem;
            font-weight: 300;
            letter-spacing: 0.5px;
        }
/* Theme Toggle */
.theme-toggle {
    position: fixed;
    top: 100px;
    right: 18px;
    width: 60px;
    height: 30px;
    background-color: #ccc;
    border-radius: 60px;
    display: flex;
    align-items: center;
    padding: 3px;
    box-shadow: inset 0 0 5px rgb(255, 255, 0);
    cursor: pointer;
    border: none;
    z-index: 1001;
}

.toggle-thumb {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background-color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    transition: transform 0.3s ease;
}

.dark-theme .theme-toggle {
    background-color: #121212;
}

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            align-items: stretch;
        }        .admin-title {
            font-size: 1.5rem;
            font-weight: 300;
            margin-bottom: 24px;
            text-align: center;
            letter-spacing: 0.5px;
        }
        .howto-title {
            font-size: 1.1rem;
            font-weight: 300;
            margin-bottom: 8px;
            letter-spacing: 0.5px;
        }
        .howto-desc {
            font-size: 1rem;
            margin-bottom: 24px;
        }
        #thesaurusBox {
            width: 100%;
            font-family: monospace;
            resize: vertical;
            min-height: 400px;
            margin-bottom: 20px;
        }
        .save-btn-row {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
        }
        .logout-btn-row {
            display: flex;
            justify-content: flex-end;
        }
        #statusMessage {
            background-color: #38b319;
            color: #121212;
            font-weight: bold;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 20px;
            text-align: center;
            display: none;
        }        .dark-theme { background-color: #121212; color: #fff; }
        .dark-theme .container { background-color: #1e1e1e; color: #fff; }
        .dark-theme #thesaurusBox { background-color: #2d2d2d; color: #fff; border: 1px solid #555; }
        .dark-theme button { background-color: #444; color: #fff; }
        .dark-theme button:hover { background-color: #555; }
        
        .footer {
            position: static;
            background-color: #072e46;
            color: white;
            padding: 20px 20px;
            text-align: center;
            margin-top: 40px;
            width: 100%;
            font-size: 0.8rem;
            bottom: 0;
            z-index: 1000;
        }
        .footer a {
            color: white;
            text-decoration: none;
        }
        .footer a:hover {
            text-decoration: underline;
        }

    </style>
</head>
<body>
<!-- Header -->
<header class="header">
    <div class="header-left">
        <img src="logo.png" alt="Logo" class="logo">
        <span class="title-text">Academic Vocabulary Search Engine</span>
    </div>
</header>
<!-- Go Back Button -->
<button class="go-back-btn" onclick="window.location.href='../public/index.html'">‚ùÆ‚ùÆ Go Home</button>
<!-- Theme Toggle -->
<div class="theme-toggle" onclick="toggleTheme()">
    <div class="toggle-thumb" id="themeEmoji">üåû</div>
</div>
<!-- Main Container -->
<div class="container">
    <div class="admin-title">Admin Panel</div>
    <div class="howto-title">How to update text files?</div>
    <div class="howto-desc">
        ‚Ä¢ To add a new word, type a <strong>hyphen (-) at the beginning</strong> of the word and type the word you want to add.<br>
        ‚Ä¢ List each word you want to add, <strong>separated by hyphens (-), without leaving any spaces.</strong><br>
        ‚Ä¢ Don't forget to <strong>click the "Save Changes" button</strong> to save the changes you made.<br>
        ‚Ä¢ Always use <strong>lower case letters</strong> for layout and <strong>leave 1 line</strong> after your list of words.
    </div>
    <textarea id="thesaurusBox" rows="25"></textarea>
    <p id="statusMessage"></p>
    <div class="file-upload-row" style="display: flex; justify-content: center; margin-bottom: 20px; gap: 10px; align-items: center;">
        <input type="file" id="fileInput" accept=".txt" style="display: none;" onchange="loadFile()">
        <button onclick="document.getElementById('fileInput').click()" style="background-color: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">üìÅ Add TXT File</button>
        <button onclick="clearTextarea()" style="background-color: #f44336; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">üóëÔ∏è Clear All</button>
    </div>
    <div class="save-btn-row">
        <button onclick="saveChanges()">Save Changes</button>
    </div>
    <div class="logout-btn-row">
        <button onclick="logout()">Log Out</button>
    </div>
</div>

<footer class="footer">
    <p style="font-size: 0.9em;">Copyright ¬© 2025 - Academic Vocabulary - Last update date: June 2025</p>
    <p style="font-size: 0.7em;">Developed by <a href="https://www.linkedin.com/in/poyrazkoca/" target="_blank">Poyraz Koca</a></p>
</footer>

<script>
    if (localStorage.getItem('auth') !== 'true') {
        window.location.href = 'admin.html';
    }
    const textarea = document.getElementById('thesaurusBox');
    const status = document.getElementById('statusMessage');
    async function loadThesaurus() {
        const res = await fetch('http://localhost:8080/api/admin/thesaurus');
        const text = await res.text();
        textarea.value = text;
    }
    let messageTimeout;
    async function saveChanges() {
        const content = textarea.value;
        const res = await fetch('http://localhost:8080/api/admin/thesaurus', {
            method: 'PUT',
            headers: { 'Content-Type': 'text/plain' },
            body: content
        });
        if (res.ok) {
            status.textContent = 'Saved successfully!';
            status.style.backgroundColor = '#a5d6a7';
            status.style.color = '#000';
            status.style.display = 'block';
            clearTimeout(messageTimeout);
            messageTimeout = setTimeout(() => { status.style.display = 'none'; }, 5000);
        } else {
            status.textContent = 'Failed to save :(';
            status.style.backgroundColor = '#ffcdd2';
            status.style.color = '#000';
            status.style.display = 'block';
            clearTimeout(messageTimeout);
            messageTimeout = setTimeout(() => { status.style.display = 'none'; }, 5000);
        }
    }
    function logout() {
        localStorage.removeItem('auth');
        window.location.href = 'admin.html';
    }
    loadThesaurus();

    //yeni dosya ekleme
    function loadFile() {
        const fileInput = document.getElementById('fileInput');
        const file = fileInput.files[0];
        
        if (file) {
            if (file.type !== 'text/plain') {
                status.textContent = 'Please select a .txt file only!';
                status.style.backgroundColor = '#ffcdd2';
                status.style.color = '#000';
                status.style.display = 'block';
                clearTimeout(messageTimeout);
                messageTimeout = setTimeout(() => { status.style.display = 'none'; }, 5000);
                return;
            }

            //veritabanƒ±nƒ±n altƒ±na yeni dosyalarƒ± ekle
            const reader = new FileReader();
            reader.onload = function(e) {
                const currentContent = textarea.value.trim();
                const newContent = e.target.result.trim();
                
                // Mevcut i√ßerik varsa, yeni i√ßeriƒüi altƒ±na ekle
                if (currentContent) {
                    textarea.value = currentContent + '\n\n' + newContent;
                } else {
                    textarea.value = newContent;
                }
                
                status.textContent = `File "${file.name}" added to existing content!`;
                status.style.backgroundColor = '#a5d6a7';
                status.style.color = '#000';
                status.style.display = 'block';
                clearTimeout(messageTimeout);
                messageTimeout = setTimeout(() => { status.style.display = 'none'; }, 5000);
            };
            reader.readAsText(file);
        }
    }

    //veritabanƒ±nƒ± temizle
    function clearTextarea() {
        if (confirm('Are you sure you want to clear all content? This action cannot be undone.')) {
            textarea.value = '';
            status.textContent = 'Content cleared!';
            status.style.backgroundColor = '#ffcdd2';
            status.style.color = '#000';
            status.style.display = 'block';
            clearTimeout(messageTimeout);
            messageTimeout = setTimeout(() => { status.style.display = 'none'; }, 5000);
        }
    }

    function toggleTheme() {
        const body = document.body;
        const emoji = document.getElementById('themeEmoji');
        const toggle = document.querySelector('.theme-toggle');

        const isDark = body.classList.toggle('dark-theme');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');

        if (isDark) {
            emoji.textContent = 'üåô';
            emoji.style.transform = 'translateX(30px)';
            toggle.style.backgroundColor = '#333';
        } else {
            emoji.textContent = 'üåû';
            emoji.style.transform = 'translateX(0)';
            toggle.style.backgroundColor = '#ccc';
        }
    }

    function applyTheme() {
        const saved = localStorage.getItem('theme');
        if (saved === 'dark') {
            document.body.classList.add('dark-theme');
            document.getElementById('themeEmoji').textContent = 'üåô';
            document.getElementById('themeEmoji').style.transform = 'translateX(30px)';
            document.querySelector('.theme-toggle').style.backgroundColor = '#333';
        }
    }
    document.addEventListener('DOMContentLoaded', applyTheme);
</script>
</body>
</html>